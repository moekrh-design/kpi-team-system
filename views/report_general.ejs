<%- include('partials/header', { pageTitle: title }) %>

<div class="card" style="max-width:1150px;margin:0 auto">
  <div class="noPrint" style="display:flex;justify-content:flex-end">
    <button class="btn printBtn" onclick="window.print()">๐จ๏ธ ุทุจุงุนุฉ / PDF</button>
    <a class="btn" style="margin-right:8px" href="/reports/general.xlsx?from=<%= from %>&to=<%= to %>">๐ ุชุตุฏูุฑ Excel</a>
  </div>

  <%- include('partials/report_header', { title, meta }) %>
  <%- include('partials/report_charts', { stats, top, topTitle }) %>

  <div class="small">ุงููุชุฑุฉ: <b><%= from || 'โ' %></b> ุฅูู <b><%= to || 'โ' %></b></div>
  <div class="hr"></div>

  <div style="overflow:auto">
    <table class="table">
      <thead>
        <tr>
          <th>ุงููููุฉ</th>
          <th>ุงูููุงุณุจุฉ</th>
          <th>ุงูููุธู</th>
          <th>ุงููุดุฑู</th>
          <th>ุงูุชูุฏู</th>
          <th>ุงูุญุงูุฉ</th>
        </tr>
      </thead>
      <tbody>
        <% if (!rows.length) { %>
          <tr><td colspan="6" class="small">ูุง ุชูุฌุฏ ุจูุงูุงุช.</td></tr>
        <% } %>
        <% rows.forEach(t => { %>
          <tr>
            <td><b><%= t.title %></b></td>
            <td class="small"><%= t.event_title || '-' %></td>
            <td class="small"><%= t.employee_name || '-' %></td>
            <td class="small"><%= t.supervisor_name || '-' %></td>
            <td style="min-width:180px">
              <div class="progressWrap">
                <div class="bar"><span style="width:<%= t.progress %>%"></span></div>
                <div class="small"><%= t.progress %>%</div>
              </div>
            </td>
            <td>
              <% if (t.status === 'completed') { %>
                <span class="badge bGood">ููุชููุฉ</span>
              <% } else if (t.status === 'pending_approval') { %>
                <span class="badge bWarn">ุจุงูุชุธุงุฑ ุงุนุชูุงุฏ</span>
              <% } else if (t.status === 'overdue') { %>
                <span class="badge bBad">ูุชุฃุฎุฑุฉ</span>
              <% } else if (t.status === 'cancelled') { %>
                <span class="badge">ููุบุงุฉ</span>
              <% } else { %>
                <span class="badge bInfo">ุฌุงุฑูุฉ</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>

  <%- include('partials/report_footer') %>
</div>

<%- include('partials/footer') %>
